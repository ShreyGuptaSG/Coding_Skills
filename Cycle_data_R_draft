library(tidyverse)  #helps wrangle data
library(lubridate)  #helps wrangle date attributes
library(ggplot2)  #helps visualize data



nrow(trip)
head(trip)
colnames(trip)
str(trip)
summary(trip)
#

head(trip$starttime)
colnames(trip)
str(trip)
summary(trip)
unique(trip$usertype)

#convert trip id from numeric to chr
trip <-  mutate(trip, trip_id = as.character(trip_id))


trip$tripduration <- trip$tripduration/60

trip <-  trip %>% 
  mutate(usertype = recode(usertype
                                ,"Subscriber" = "Member"
                                ,"Customer" = "Short-Term Pass Holder"))
trip<-subset(trip, usertype !="starttime" )

unique(trip$gender)

trip <-  replace_na(trip,list(gender = "Other"))

ggplot(data = trip) +geom_point(aes(x = usertype, y = tripduration))  

########
---
  title: "Example Starter R Script"
output: html_document
---
  
  ## Introduction and background
  This is meant to be a sample starter script if you choose to use R for this case study. This is not comprehensive of everything you'll do in the case study, but should be used as a starting point if it is helpful for you.

## Upload your CSV files to R
Remember to upload your CSV files to your project from the relevant data source:
https://www.kaggle.com/arashnic/fitbit

Remember, there are many different CSV files in the dataset. We have uploaded two CSVs into the project, but you will likely want to use more than just these two CSV files.

## Installing and loading common packages and libraries
You can always install and load packages along the way as you may discover you need different packages after you start your analysis. If you already have some of these packages installed and loaded, you can skip those ones - or you can choose to run those specific lines of code anyway. It may take a few moments to run.
'
```{r}
install.packages('tidyverse')
library(tidyverse)
```


## Loading your CSV files
Here we'll create a dataframe named 'daily_activity' and read in one of the CSV files from the dataset. Remember, you can name your dataframe something different, and you can also save your CSV file under a different name as well.
'
```{r}
daily_activity <- read.csv("dailyActivity_merged.csv")
```

#We'll create another dataframe for the sleep data. 
```{r}
sleep_day <- read.csv("sleepDay_merged.csv")
```

## Exploring a few key tables

#Take a look at the daily_activity data.
```{r}
head(daily_activity)
```

#Identify all the columsn in the daily_activity data.
```{r}
colnames(daily_activity)
```

#Take a look at the sleep_day data.
```{r}
head(sleep_day)
```

#Identify all the columsn in the daily_activity data.
```{r}
colnames(sleep_day)
```

#'Note that both datasets have the 'Id' field - this can be used to merge the datasets.'

## Understanding some summary statistics
#How many unique participants are there in each dataframe? It looks like there may be more participants in the daily activity dataset than the sleep dataset.

```{r distinct users}
n_distinct(daily_activity$Id)
n_distinct(sleep_day$Id)
```

#How many observations are there in each dataframe?
```{r observations}
nrow(daily_activity)
nrow(sleep_day)
```

#'What are some quick summary statistics we'd want to know about each data frame?'
  
  #For the daily activity dataframe:
  ```{r}
daily_activity %>%  
  select(TotalSteps,
         TotalDistance,
         SedentaryMinutes) %>%
  summary()
```

For the sleep dataframe:
  ```{r}
sleep_day %>%  
  select(TotalSleepRecords,
         TotalMinutesAsleep,
         TotalTimeInBed) %>%
  summary()
```

What does this tell us about how this sample of people's activities? 

## Plotting a few explorations

What's' the relationship between steps taken in a day and sedentary minutes? How could this help inform the customer segments that we can market to? E.g. position this more as a way to get started in walking more? Or to measure steps that you're already taking?

```{r}
ggplot(data=daily_activity, aes(x=TotalSteps, y=SedentaryMinutes)) + geom_point() +geom_smooth()
```

What's the relationship between minutes asleep and time in bed? You might expect it to be almost completely linear' - are there any unexpected trends?
  
  ```{r}
ggplot(data=sleep_day, aes(x=TotalMinutesAsleep, y=TotalTimeInBed)) + geom_point() +geom_smooth()
```

What could these trends tell you about how to help market this product? Or areas where you might want to explore further?
  
  ## Merging these two datasets together
  
  ```{r}
combined_data <- merge(sleep_day, daily_activity, by="Id", all.x =TRUE)
```

Take a look at how many participants are in this data set.

```{r}
n_distinct(combined_data$Id)
```

Note that there were more participant Ids in the daily activity dataset that have been filtered out using merge. Consider using 'outer_join' to keep those in the dataset. 

Now you can explore some different relationships between activity and sleep as well. For example,
do you think participants who sleep more also take more steps or fewer steps per day? Is there a relationship at all? How could these answers help inform the marketing strategy of how you position this new product
  This is just one example of how to get started with this data - there are many other files and questions to explore as well!
  
  ########
  install.packages('lubridate')
install.packages('tidyverse')
install.packages('ggplot2')
library(tidyverse)  #helps wrangle data
library(lubridate)  #helps wrangle date attributes
library(ggplot2)  #helps visualize data
#=====================
# STEP 1: COLLECT DATA
#=====================
# Upload NSW APDD datasets (csv files) here
NSW_JULY_2015_APDD <- read_csv("NSW_JULY_2015_APDD.csv")
NSW_2016_APDD  <- read_csv("NSW_2016_APDD.csv")
NSW_2017_APDD <- read_csv("NSW_2017_APDD.csv")
NSW_2018_APDD <- read_csv("NSW_2018_APDD.csv")
NSW_2019_APDD <- read_csv("NSW_2019_APDD.csv")
NSW_2020_APDD <- read_csv("NSW_2020_APDD.csv")
NSW_2021_JUNE_APDD <- read_csv("NSW_JUNE_2021_APDD.csv")

str(NSW_2016_APDD)

#BINDING ROWA
NSW_PMD <- bind_rows(NSW_JULY_2015_APDD, NSW_2016_APDD, NSW_2017_APDD, NSW_2018_APDD, NSW_2019_APDD, NSW_2020_APDD, NSW_2021_JUNE_APDD)

#======================================================
# STEP 3: CLEAN UP AND ADD DATA TO PREPARE FOR ANALYSIS
#======================================================
# Inspect the new table that has been created
colnames(NSW_PMD)  #List of column names
nrow(NSW_PMD)  #How many rows are in data frame?
dim(NSW_PMD)  #Dimensions of the data frame?
head(NSW_PMD)  #See the first 6 rows of data frame.  Also tail(all_trips)
str(NSW_PMD)  #See list of columns and data types (numeric, character, etc)
summary(NSW_PMD)  #Statistical summary of data. Mainly for numerics

NSW_PMD$SETTLEMENTDATE <- as.Date(NSW_PMD$SETTLEMENTDATE, "%d/%m/%Y")
write.csv(NSW_PMD, file = "NSW_PMD.csv")


    
    
    
    
ggplot(data = combined_data) + geom_point(aes( TotalSteps, TotalMinutesAsleep))

summary(combined_data)
